# Intraday Trading System Configuration

system:
  name: "Intraday Trading System"
  version: "1.0.0"
  mode: "paper"
  timezone: "America/New_York"

collectors:
  # DEPRECADO: Reemplazado por grok
  twitter:
    enabled: false
    engine: "twscrape"
    accounts_pool_size: 5
    rate_limit_buffer: 0.8
    refresh_interval_seconds: 15

  reddit:
    enabled: false
    use_streaming: true
    batch_fallback_interval: 60

  stocktwits:
    enabled: false
    refresh_interval_seconds: 30

  # NUEVO: Grok collector (configuración ultra-optimizada para costos mínimos)
  grok:
    enabled: true
    refresh_interval_seconds: 900  # 15 min (vs 30 seg original = 96% reducción de búsquedas)
    max_results_per_query: 5       # Solo top 5 tweets más relevantes
    search_queries:
      # SOLO cuentas tier1 verificadas (evita búsquedas amplias por keywords)
      - "from:unusual_whales"      # Options flow institucional
      - "from:DeItaone"             # Breaking news financiero
      - "from:FirstSquawk"          # Noticias mercado

risk:
  circuit_breakers:
    per_trade:
      max_loss_percent: 1.0
      hard_stop: true
    daily:
      max_loss_percent: 3.0
      max_trades_after_loss: 0
      cooldown_minutes: 60
    weekly:
      max_loss_percent: 6.0
      force_paper_mode: true

# CAPA 2: Análisis
analyzers:
  # DEPRECADO: FinTwitBERT reemplazado por sentiment nativo de Grok
  sentiment:
    enabled: false
    model: "StephanAkkerman/FinTwitBERT-sentiment"
    batch_size: 32
    min_confidence: 0.7

  claude:
    enabled: true
    model: "claude-sonnet-4-20250514"
    max_tokens: 1000
    rate_limit_per_minute: 20
    use_for:
      - catalyst_classification
      - risk_assessment
      - context_analysis

# CAPA 3: Technical Validation
validators:
  technical:
    enabled: true
    rsi_period: 14
    rsi_overbought: 70.0
    rsi_oversold: 30.0
    macd_fast: 12
    macd_slow: 26
    macd_signal: 9
    stoch_k_period: 14
    stoch_d_period: 3
    adx_period: 14
    adx_trend_threshold: 20.0
    options_volume_spike_ratio: 2.0
    iv_rank_warning_threshold: 80.0
    veto_mode: true
    lookback_bars: 50
    timeframe: "5Min"

# CAPA 4: Scoring System
scoring:
  enabled: true

  # Score thresholds
  tier_strong_threshold: 80
  tier_moderate_threshold: 60
  tier_weak_threshold: 40

  # Position sizing (percentage)
  position_size_strong: 100.0
  position_size_moderate: 50.0
  position_size_weak: 25.0

  # Trade parameters
  default_stop_loss_percent: 2.0
  default_risk_reward_ratio: 2.0

  # Dynamic weights
  base_sentiment_weight: 0.5
  base_technical_weight: 0.5
  strong_trend_adx: 30.0
  weak_trend_adx: 20.0

  # Confluence settings
  confluence_window_minutes: 15
  confluence_bonus_2_signals: 0.10
  confluence_bonus_3_signals: 0.20

  # Time factors
  premarket_factor: 0.9
  afterhours_factor: 0.8
  earnings_proximity_days: 3
  earnings_factor: 0.7

  # Source credibility multipliers (DEPRECADO - ahora es dinámico)
  credibility_tier1_multiplier: 1.2
  credibility_tier2_multiplier: 1.0
  credibility_tier3_multiplier: 0.8

  # Credibilidad dinámica (NUEVO)
  tier1_seeds:
    # Seeds iniciales - el sistema aprenderá y ajustará automáticamente
    - unusual_whales
    - DeItaone
    - FirstSquawk

  # Configuración de aprendizaje
  min_signals_for_dynamic: 5           # Mínimo de señales antes de ajustar credibilidad
  evaluation_window_minutes: 30        # Ventana para evaluar si señal fue correcta
  success_threshold_percent: 1.0       # +1% para considerar señal exitosa

# CAPA 5: Risk Management Settings
risk_settings:
  enabled: true
  max_position_value: 1000.0
  max_daily_loss: 500.0
  unrealized_warning_threshold: 300.0

# CAPA 6: Execution
execution:
  enabled: true
  paper_mode: true
  default_time_in_force: "day"

# CAPA 0: Market Condition Gate
market_gate:
  enabled: true
  trading_start: "09:30"
  trading_end: "16:00"
  avoid_lunch: true
  lunch_start: "11:30"
  lunch_end: "14:00"
  spy_min_volume: 500000
  qqq_min_volume: 300000
  vix_max: 30.0
  vix_elevated: 25.0
  elevated_size_factor: 0.5
  choppy_detection_enabled: true
  choppy_atr_ratio_threshold: 1.5

# Phase 8: Trading Orchestrator
orchestrator:
  enabled: true
  immediate_threshold: 0.85
  batch_interval_seconds: 60
  min_consensus: 0.6
  max_buffer_size: 1000
  continue_without_validator: true
  gate_fail_safe_closed: true

# Phase 9: Notifications
notifications:
  enabled: true
  # telegram_token and chat_id from environment variables:
  # TELEGRAM_BOT_TOKEN and TELEGRAM_CHAT_ID
  alert_types:
    - new_signal
    - entry_executed
    - exit_executed
    - circuit_breaker
    - daily_summary
  pre_market_checklist_enabled: true
  pre_market_checklist_time: "09:00"
  checklist_items:
    - "Economic calendar reviewed"
    - "Overnight news checked"
    - "Watchlist prepared"
    - "Mental state: focused"
    - "Risk parameters confirmed"

# Phase 10: Journal
journal:
  enabled: true
  data_dir: "data/trades"
  auto_log_entries: true
  auto_log_exits: true
  default_period_days: 30
  weekly_report_enabled: true
  weekly_report_day: "saturday"

# Morning Research Agent
research:
  enabled: true
  timezone: "Europe/Madrid"
  initial_brief_time: "12:00"
  pre_open_brief_time: "15:00"
  claude_model: "claude-sonnet-4-20250514"
  max_tokens: 4000
  max_ideas: 5
  max_watchlist: 5
  briefs_dir: "data/research/briefs"
  inject_to_orchestrator: true
  telegram_enabled: true
  telegram_summary: true
